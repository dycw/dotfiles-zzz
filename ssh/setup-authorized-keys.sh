#!/usr/bin/env bash

echo "$(date '+%Y-%m-%d %H:%M:%S'): Setting up authorized keys..."

file="$HOME/.ssh/authorized_keys"
if ! [ -f "$file" ]; then
	mkdir -p "$(dirname "$file")"
	touch "$file"
fi

items=(
	'Laptop|ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDjr6+KgERdmbuQxGD4E9eUgd2jeb0z+/6TpQVjlq2Z0EwWrXYeGkOO5HEFcxnQQBZXeeLhSbqOthP4FYjh4JXorAjRSi/qPGU3Wdv/08k2klZQVhjrmg6fYFq3JL2bIA2AtYMZD8Tg7EF9pZ8V3P2mfMXaM/yQJqOYgQ/dNGvpODn/paM84tzfmrIKMV4W/dZB87rOacotcPtWEJMSLQifKlAye0qshm690qEFeEVgJDOxSmTAcio8EFkOh7UU+Pc+MrrYA6QSRJ3VUKEXrz2DDa4m5FAma2jMuuGMR+cpVgJXv9yIFqyxN94nPb7PKh+ELJSXXXbEuIFh6sxNCgcBbIqwPiNudWdlxLVTFvkMsLu41vekjOzm/InWfXQEe18B6fBJB9SNJWbJQY3lg326KkhoLj6hhkTV/L2vWG59huqp3dJVsO3X7ZF0O71yn9W0veI8uogt8lFoOOLpFLvTUO4gqiva665dxe4bS5vgELLin7ZlFxGQJLkbz6oMfV+thxm1Kx/z1r+Ob1xS+awSoGPWbcnzwilshV+OxZL0zEYTu3pIMDGWDPHtdudc/wW5E7/oGWg0wMoN3kZ6zEDY51Jr2lTk0dnK27q/F3HcidbOtUtDYib6PnMKJN2qyp3GYcomLc0aENTmh7S6NhQ+1bFfXqfwU4Q3TL+msC3JbQ=='
	'Mac|ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDfeb4P7VlTcyUff66EibpMNi5JOfvOFBl/M+0jOHzFlUyl/6tT9tXacAbN1U9Y/MJuA+zKFFZsSWZ/NBG9MIPsr3C4BECjjLsRA57YRGbQmwuPGN6pWo3deq9d5CD+pozOb47GX10T+toTWu+LXNCLYYOTiRQx6CUMINSVcctJVqrsFDUrhRZbQzCXuOBUVok+h6NFSfPbuf1yKyaqFlkWYgoDGAchHDwzkn0Bf+4ukcA97mipHsSlHrEqEWlc1QQZdsfdjfT9FT163rO5LfHh0rGdurpSQmbzGdBGolVJ0qf2dcQTkDJop/zbVrQNjMlnLOBn//lFlHb1p9TVU+5VntEnmcdvXC/zmzqoQjufKIT+XhYWvJz1Z9VU8W/VK68N7BC7LcBslOC0f/okVD7+dMhkZ3YpcYZdqN6aw+R9rn0dCQzZYDl5C/u8Eq8RPjyATYTfuuUqn8OiCApSBl1QUuTib056IyjECi82MuaQWww3PWLTfAbVDPuNdH/j+5nwnl7OrnIE2v7E8nsNw3kdOhRxY7gfTTf3fzXNkkM2KN5ODMhD2J2HvjLGK9gXVcSUyx0fxp5xY08WH5E/6EumdMHuj/vjFP/gtlGduulCTKfvNUuGsX2u8iVSeiN8vDTY8REZZedRBkfZXEGF8dyD6D4+NCZQ1/16wEnjLVKgWw=='
	'NUC 10|ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCh/ysoUgqX5FSO74W74PYnWH1WZ0pmhDbc33tSCkq1FDyu5TYiOcEorrIE8luPprBJkWPb4MVV5KtllrJB5PpnRo53qozePEpyt1H8uXmRjAVjOvzb3v3yZJuenH/h7XwAVJX0XkZZkZBDMQcRew1WV8Y9aP2883T4eI8JSXZTXjCbxTbqfGhtW4Haw/TYTLIYPQAuvfYu9biDy64ZgIZwOF8aLBptNLRI67y+NrSp+SfuoiB0UFPKbeVW6KGV2AI6ya4wbDnkPFRQ9E2zdR9wgm/rxObRZ8/qCZ/GvawIZAYzTRwPC5UJioa26gmWOoxc5Sqz4a+aqu0t1qv0uZKimTFkHAuEHSpFPuIvm4p6mdUBnG+6Wft4egJexUj/howInJk+/YKxua9dsaJftg3fTQsB6HDB2GRu3tZZzNioe48RTTTLnqzqg1HxY2uVqaV8bMYzrJ0h7RnlWGz8YQ8TR6XcSNfyrD/FTHr4GWKGjM1mvEK6vzAdHu3rjJvh31b7Fk7V+XOtcNoSwf0pbDXeQKyfV3Ay2wTsapIVoJr6ltVOyH1rWq102td5QVJin2BMoCQMYbjndv0//eDJodfes6U0/h0Ttv8g6bvc/lBlWEZ4u5p3bOnx2LR7x7/JucXxsbOezO4kJc4sZVOpf3GY74DjV0imJiDg4lDfozn7AQ=='
	'NUC 11|ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC8LTlqTGxTNrBFVUmnpsEw38c0iHpbVIv0KQuT0oPLdEtcg8AThx4IBQK2xE6zoL1X4MyOMyv/KalirJzVB1ubhfenJ++bK1Wnq9JXVlHqZ7GrueanLqxyPQIPHUVM4bOjXsl4rnzZ3M9tKAsXvGJYq3OKJjUdBX8X8LXL6x4mrTe9htuV9a2g2YZzXgOe7ZRMLdRgDIPl73R2k0GSr9Fusd0Nzy49M6+DLtOA8LuzzFiPjvWmv0gF5EsTbbZTr9bJxFcd5Dt+K5hLMXfdGlIICknm5XhmAio+yYJ5HI6SJwRUI5gVPKaJFtQOfguALIF4gqOJCwyM1c0fJCOTfBzHOwUjYzPaTHR8rKk2a2Ny/FKEA+Tlv1xu93fRnVbIk0eMzCbt1+7pvBf2wx2OFh84ZMJ+Ji/brRUllhkyQGAozVmb/P1GQ6AylzjaKwz27s9cTrLTMsoBYz0eAB3NdlQ/ajFAeFlHK2dQWduTHH7DHU9647djO7uQ4lzqP+jU1VUew7XU2BVaN6mv8MHX4Tj3h4KDGkk4uGQTIYzL/1Q0rP1wjc9T7uhhb/PyMwE8odHHEdKEV2Ag5y7+j/lv8JC1yekQRuTSjkYd2GGAxqf2n5laHB32+46Y9uICqLvZLnIZqL0Pmihpi/sPARCxPFh3VGyc/oJoVs0UOS7ibhdEVQ=='
	'PC|ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDliPoXZd3C+U/PAESA3U/fRjqBGDfiF0F/ngTT5F3UYAFf2Ho2ujeN9msNKMsNf2yilPER4R8nB6nhOt2HBYpf0M7r4T1N4lNQCSqzN0h0eNWO0yr/3D0G2jFmPrJjzSbQE2HP8lXG/4ywjIyYXAyd9MD1h9ChLrwZAFok644Hh+qBKs23flZWLS0udUmGRUJXazNbudlxiZf34h+XnaWnDZWphnbe1FoadtqDXsEgbxdCUTvAsTMnS1uWk/AtBCBTsLV0OqDjxI0/Tp/6PU9q+lSSFVvHvIPjVEMHoi2TQ9b5qmAbRsJfPGbfwXejgk2qyE+DiulaHt34dGbmYhH3BPw9hMUDoIJJcnCItT6g/8agNMMTzVvrXjjLf47conOvwxhCIr3PHx2lTPr5pehoL1xSfbr97fHGLlx444RRy3Z+HVlhl0zjrqOdBCkk7xP5RbFvGLRMiqWBsFgWFY2xocDKuPtmPU6wr9J5QEXfkNTWyoravWhir2R31P6ZkI2MuHsafV7L7qME5DCauc1NQP9MnQv9YMOin0s8gwufNH6MdBriCyF/N9FxCg8Hbm+LB2telqtdFQ5Ql81kI8Rf8QpS1//2feyzhfzKtQNNjnbtnvYxATtS3D0Hh5+cPh1czdkhY+wHI9GTON6E8+4FbugsPTRi+SfaYA23hX0UEw=='
)
for item in "${items[@]}"; do
	key="$(echo "$item" | cut -d '|' -f 1)"
	value="$(echo "$item" | cut -d '|' -f 2)"
	if ! grep -Fxq "$value" <<<"$(cat "$file")"; then
		echo "# $key" >>"$file"
		echo "$value" >>"$file"
	fi
done
