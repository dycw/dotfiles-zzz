#!/usr/bin/env bash

mapfile -td : parts < <(printf "%s\0" "$WATCHEXEC_WRITTEN_PATH")
for part in "${parts[@]}"; do
	file="$(pwd)$part"
	if [ -f "$file" ]; then
		echo "$(date +"%Y-%m-%d %H:%M:%S"): $file"
		if [ -x "$(command -v autoflake)" ]; then
			autoflake --in-place --remove-all-unused-imports --remove-duplicate-keys "$file"
		else
			echo 'autoflake missing'
		fi
		if [ -x "$(command -v black)" ]; then
			black "$file"
		else
			echo 'black missing'
		fi
		if [ -x "$(command -v isort)" ]; then
			isort "$file"
		else
			echo 'isort missing'
		fi
	fi
done
